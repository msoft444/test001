# 要件定義書：テーマ切替（ダーク/寒色/暖色）

## 1. 目的/スコープ
### 1.1 目的
現状「ダークモードのみ」提供されている前提の見た目切替機能を拡張し、ユーザーが **寒色系（Cool）** / **暖色系（Warm）** を含む複数テーマへ切り替えできるようにする。

### 1.2 スコープ
- 対象：ダッシュボード（marunage-dashboard）での表示（会話一覧、会話詳細、タスク/ログ、成果物表示、フォーム、通知）
- 対象：テーマ設定の保持・伝搬（必要に応じてバックエンド/DBに保存）
- 非対象：エージェントの推論品質、タスク実行ロジックそのものの変更

### 1.3 用語
- テーマ(theme)：UIの色・背景・アクセント等のトークンセット。
- ダーク(dark)：暗い背景ベースのテーマ。
- 寒色(cool)：青/シアン寄りの色温度。
- 暖色(warm)：橙/赤寄りの色温度。

## 2. 機能要件
### FR-1 テーマ種別
- dark / cool / warm を選択可能
- 将来拡張で system（OS設定追従）を内部的に許容

### FR-2 切替UI
- ヘッダーまたは設定画面から常時アクセス可能
- 変更は即時反映（リロード不要）

### FR-3 永続化
- localStorage に保存し再訪時復元
- サーバ側保存は任意拡張

### FR-4 互換性
- 未設定/不正値はデフォルトへフォールバック
- 既存表示（Markdown、コードブロック等）を崩さない

### FR-5 アクセシビリティ
- WCAG AA 相当のコントラスト目標
- 状態表現が色のみに依存しない

### FR-6 運用/観測性
- テーマ変更イベントのログ送信可能

## 3. 非機能要件
- パフォーマンス：切替100ms以内
- 安定性：不正値で例外発生しない
- セキュリティ：ホワイトリスト検証、CSS/JS注入不可
- 互換性：constraints_json 運用に影響なし

## 4. 制約・前提
- 本リポジトリはPython基盤、UI別リポジトリ
- DB: MariaDB、constraints_json は list/dict 両運用
- ダッシュボード連携はメッセージバス/WS